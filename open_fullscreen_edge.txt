def open_fullscreen():
    time.sleep(1)  # espera a que el servidor escuche
    url = "http://127.0.0.1:5000"
    edge = find_edge()

    # Cierra Edge si est√° abierto, para que respete los flags
    try:
        subprocess.run(["taskkill", "/IM", "msedge.exe", "/F"], stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)
    except Exception:
        pass

    # Lanza Edge en modo kiosco (pantalla completa de verdad)
    # Docs oficiales: msedge.exe --kiosk <URL> --edge-kiosk-type=fullscreen --no-first-run
    subprocess.Popen(
        [edge, "--kiosk", url, "--edge-kiosk-type=fullscreen", "--no-first-run"],
        stdout=subprocess.DEVNULL,
        stderr=subprocess.DEVNULL,
        creationflags=getattr(subprocess, "DETACHED_PROCESS", 0)
    )